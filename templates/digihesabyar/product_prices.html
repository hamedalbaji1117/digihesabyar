{% extends "layouts/base.html" %}
{% load humanize %}
{% block content %}
<div class="space-y-6">
  <div>
    <h1 class="text-2xl font-bold mb-2">مدیریت قیمت‌های خرید کالاها</h1>
    <p class="text-sm text-gray-600 dark:text-gray-300">
      در این صفحه می‌توانید قیمت خرید تمام کالاهای خود را مشاهده و ویرایش کنید.
      این قیمت‌ها برای محاسبه سود و زیان در صورتحساب‌های آینده به‌صورت خودکار مورد استفاده قرار خواهند گرفت.
    </p>
  </div>
  <div class="bg-white dark:bg-slate-900 rounded-xl p-4 shadow-sm">
    <h2 class="text-lg font-semibold mb-3">لیست کالاها و قیمت خرید</h2>
    {% if products %}
      <form method="post" class="space-y-3">
        {% csrf_token %}
        <div class="overflow-x-auto">
          <table class="min-w-full text-sm">
            <thead>
              <tr class="border-b text-left">
                <th class="py-2 px-2">ردیف</th>
                <th class="py-2 px-2">کد تنوع (DKPC)</th>
                <th class="py-2 px-2">عنوان کالا</th>
                <th class="py-2 px-2">قیمت خرید (ریال)</th>
              </tr>
            </thead>
            <tbody>
              {% for p in products %}
              <tr class="border-b last:border-0">
                <td class="py-2 px-2">{{ forloop.counter }}</td>
                <td class="py-2 px-2 font-mono">{{ p.dkpc }}</td>
                <td class="py-2 px-2">{{ p.title|default:"" }}</td>
                <td class="py-2 px-2">
                  <input type="text" name="price_{{ p.dkpc }}" value="{{ p.purchase_price|default_if_none:'0' }}"
                         class="w-40 rounded border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 px-2 py-1 text-right text-sm" />
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        <div class="flex justify-end">
          <button type="submit" class="inline-flex items-center px-4 py-2 rounded-lg text-sm font-semibold bg-emerald-600 text-white hover:bg-emerald-700">
            ذخیره قیمت‌ها
          </button>
        </div>
      </form>
    {% else %}
      <p class="text-sm text-gray-600 dark:text-gray-300">هنوز هیچ کالایی در لیست قیمت خرید ثبت نشده است.</p>
    {% endif %}
  </div>
  <div class="flex justify-end">
    <a href="{% url 'digihesabyar:dashboard' %}" class="inline-flex items-center px-3 py-2 rounded-lg text-sm font-semibold bg-gray-200 hover:bg-gray-300 dark:bg-slate-800 dark:hover:bg-slate-700 text-slate-900 dark:text-slate-100">
      بازگشت به داشبورد
    </a>
  </div>
</div>
{% endblock %}
